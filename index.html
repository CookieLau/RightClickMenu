<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>生成右键菜单注册文件 - RightClickMenu</title>

    <link href="https://www.jeasyui.com/easyui/themes/bootstrap/tree.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <style>
        .tree-node {
            line-height: 25px;
            white-space: nowrap;
            cursor: pointer;
            height: auto;
        }
    </style>
</head>
<body class="bg-light">

<div>
    <nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top mb-4">
        <div class="container">
            <a class="navbar-brand" href="#">RightClickMenu</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item active">
                        <a class="nav-link" href="https://github.com/GHBJayce/RightClickMenu" target="_blank">
                            For Github
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="row">
            <div class="col-md-7">
                <div class="p-3 bg-white rounded shadow-sm">
                    <h6 class="mb-4">操作台</h6>
                    <div class="">
                        <ul id="treeWrap" class="easyui-tree"></ul>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <div class="p-3 bg-white rounded shadow-sm">
                    <h6 class="mb-4">
                        描述
                        <a href="https://ghbjayce.github.io/RightClickMenu/" class="pull-right">Online</a>
                    </h6>
                    <div class="alert alert-warning" role="alert">
                        <strong><i class="fa fa-exclamation-triangle"></i> 请在本地服务器环境中使用该程序</strong>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="mb-4">
                        <div class="mb-2">
                            <a href="https://github.com/GHBJayce/RightClickMenu" class="text-success" target="_blank">
                                <i class="fa fa-github"></i> GHBJayce/RightClickMenu
                            </a>
                        </div>
                        <img class="mr-2" src="https://img.shields.io/github/stars/GHBJayce/RightClickMenu.svg" alt="stars">
                        <img class="mr-2" src="https://img.shields.io/github/forks/GHBJayce/RightClickMenu.svg" alt="forks">
                        <img src="https://img.shields.io/github/license/GHBJayce/RightClickMenu.svg" alt="license">
                    </div>
                    <p>生成右键菜单注册表文件</p>
                </div>
            </div>
        </div>
        <h4>

        </h4>
        <div class="alert alert-info h6" role="alert">
            <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <p><i class="fa fa-info-circle" style="font-size: 20px;"></i> 直接点击生成按钮，能够得到一个右键菜单的小功能。</p>
            <p>右键<strong>选中文件或文件夹</strong>能够复制选中目标的路径，可以放心下载到本地环境中导入使用。</p>
        </div>
        <br>
        <form class="form-horizontal">
            <div class="form-group">
                <label for="itemName" class="col-sm-2 control-label">注册表名</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="itemName" placeholder="在注册表显示的注册名称" value="CopyPath">
                </div>
            </div>
            <div class="form-group">
                <label for="showName" class="col-sm-2 control-label">右键菜单名</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="showName" placeholder="右键菜单显示的名称" value="复制目标路径">
                </div>
            </div>
            <div class="form-group">
                <label for="path" class="col-sm-2 control-label">程序路径</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="path" placeholder="程序路径" value="mshta vbscript:clipboarddata.setdata(&#34;text&#34;,&#34;%1&#34;)(close)">
                    <!-- <input type="file" id="path" placeholder="程序路径"> -->
                </div>
            </div>
            <div class="form-group">
                <label for="icon" class="col-sm-2 control-label">图标</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="icon" placeholder="显示的图标，留空表示使用程序默认的图标" value="%SYSTEMROOT%\explorer.exe">
                    <!-- <input type="file" id="icon" placeholder="显示的图标"> -->
                </div>
            </div>
            <div class="form-group">
                <label for="options" class="col-sm-2 control-label">右键菜单</label>
                <div class="col-sm-10">
                    <label class="checkbox-inline">
                        <input type="checkbox" name="option" id="inlineCheckbox1" value="1"> 目录背景
                    </label>
                    <label class="checkbox-inline">
                        <input type="checkbox" name="option" id="inlineCheckbox2" value="2" checked> 选中文件夹
                    </label>
                    <label class="checkbox-inline">
                        <input type="checkbox" name="option" id="inlineCheckbox3" value="3" checked> 所有选中文件
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label"><b>目录背景</b> <br> 按<code>shift</code>键出现</label>
                <div class="col-sm-10">
                    <label class="radio-inline">
                        <input type="radio" name="backgroundExtended" value=""> 是
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="backgroundExtended" value="no" checked> 否
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label"><b>选中文件夹</b> <br> 按<code>shift</code>键出现</label>
                <div class="col-sm-10">
                    <label class="radio-inline">
                        <input type="radio" name="selectedDirectory" value=""> 是
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="selectedDirectory" value="no" checked> 否
                    </label>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label"><b>所有选中文件</b> <br> 按<code>shift</code>键出现</label>
                <div class="col-sm-10">
                    <label class="radio-inline">
                        <input type="radio" name="selectedAll" value=""> 是
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="selectedAll" value="no" checked> 否
                    </label>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" id="generateBtn" class="btn btn-primary col-xs-4">生成</button>
                </div>
            </div>
        </form>
        <div class="col-sm-12" id="downloadWrap" style="display: none;">
            <div>
                <a href="register_table_file.zip" download=""><button class="btn btn-success">下载文件</button></a>
            </div>
            <div class="col-sm-6">
                <h5>创建注册表</h5>
                <pre id="createRegText"></pre>
            </div>
            <div class="col-sm-6">
                <h5>删除注册表</h5>
                <pre id="removeRegText"></pre>
            </div>
        </div>
    </main>

    <footer class="footer mb-4">
        <div class="container clearfix">
            <span class="text-muted align-middle pull-right">author by <a href="https://github.com/GHBJayce" target="_blank">GHBJayce</a>.</span>
        </div>
    </footer>
</div>

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://www.jeasyui.com/easyui/plugins/jquery.parser.js"></script>
<script src="https://www.jeasyui.com/easyui/plugins/jquery.draggable.js"></script>
<script src="https://www.jeasyui.com/easyui/plugins/jquery.droppable.js"></script>
<script src="https://www.jeasyui.com/easyui/plugins/jquery.tree.js"></script>
<script src="https://cdn.bootcss.com/toastr.js/2.1.4/toastr.min.js"></script>
<script src="https://cdn.bootcss.com/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/vue/2.5.17/vue.min.js"></script>
<script>
    $(function () {
        var treeWrap = $('#treeWrap');
        var app = new Vue({
            el: '#app',
            data: {
                vTreeParams: {
                    draggable: true,
                },
                dataList: [
                    {
                        text: '默认分组',
                        children: [
                            {
                                text: '复制目标路径',
                            },
                        ],
                    },
                ],
            },
            created: function () {
                var _this = this;
                treeWrap.tree({
                    dnd: true,
                    lines: true,
                    checkbox: true,
                    data: this.dataList,
//                    formatter: function (node) {
//                        var template = node.text;
//                    },
                    onClick: function (node) {
                        console.log(node);
                    },
                    onBeforeDrop: function (target, source, point) {
                        console.log(target, source, point);
                        if (point === 'append') {
                            var parentNode = treeWrap.tree('getParent', target);
                            if (parentNode === null) {

                            } else {
                                toastr.error('最多支持二级菜单');
                                return false;
                            }
                        }
                    },
                });

                setTimeout(function () {
                    _this.dataList.push({
                        text: '威格尔',
                    });
                    console.log(_this.dataList);
                    treeWrap.tree('loadData', _this.dataList);
                }, 3000);
            },
            methods: {

            },
        });
    });
    $('#generateBtn').on('click', function (){
        var options = [];
        var extended = {
            1: $('[name="backgroundExtended"]:checked').val(),
            2: $('[name="selectedDirectory"]:checked').val(),
            3: $('[name="selectedAll"]:checked').val()
        }

        $("input[name='option']:checked").each(function(i) {
            options[i] = $(this).val();
        });

        $.ajax({
            url: './php/index.php',
            type: 'post',
            data: {
                item_name: $('#itemName').val(),
                show_name: $('#showName').val(),
                path: $('#path').val(),
                icon: $('#icon').val(),
                extended: JSON.stringify(extended),
                options: JSON.stringify(options)
            },
            success: function (res){
                $('#downloadWrap').show();
                res = JSON.parse(res);
                $('#createRegText').text(res.create_reg_text);
                $('#removeRegText').text(res.remove_reg_text);
            }
        });
        return false;
    });
</script>
</body>
</html>